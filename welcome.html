<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome - ChatGPT Bookmark & Prompt Manager</title>
    <meta name="description"
        content="You've installed ChatGPT Bookmark & Prompt Manager. Start supercharging your ChatGPT experience.">
    <link rel="icon" type="image/svg+xml" href="/chat-navigator/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/chat-navigator/favicon-32.png">
    <script>
        // Capture install_id before GTM/GA loads and strip it from the URL.
        (function () {
            try {
                var params = new URLSearchParams(window.location.search);
                var raw = params.get('install_id');
                if (raw) {
                    window.__install_id = raw;
                    params.delete('install_id');
                    var next = params.toString();
                    var clean = window.location.pathname + (next ? '?' + next : '') + window.location.hash;
                    history.replaceState({}, '', clean);
                }
            } catch (e) { }
        })();
    </script>
    <script>
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({ page_type: 'welcome', site: 'infolily', locale: 'en' });

        // Track App Install Event (Fire Once & Only for Real Installs)
        // window.__install_id is set by the script above if ?install_id= is present
        if (window.__install_id && !localStorage.getItem('install_tracked')) {
            window.dataLayer.push({
                'event': 'app_install',
                'install_timestamp': new Date().toISOString()
            });
            localStorage.setItem('install_tracked', 'true');
        }
    </script>
    <script>(function (w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-5FBJMJQG');</script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            background: #0a0a0f;
            background-image: radial-gradient(ellipse at 50% 0%, rgba(99, 102, 241, 0.15) 0%, transparent 50%), radial-gradient(ellipse at 80% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 40%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .container {
            max-width: 700px;
            text-align: center;
            padding: 40px 24px;
            position: relative
        }

        /* Success Ring */
        .success-wrap {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 40px
        }

        .success-ring {
            width: 120px;
            height: 120px
        }

        .ring-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 4
        }

        .ring-progress {
            fill: none;
            stroke: url(#grad);
            stroke-width: 4;
            stroke-linecap: round;
            stroke-dasharray: 339;
            stroke-dashoffset: 339;
            animation: drawRing .7s ease forwards
        }

        .checkmark {
            stroke: #10b981;
            stroke-width: 5;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            stroke-dasharray: 60;
            stroke-dashoffset: 60;
            animation: drawCheck .5s .5s ease forwards
        }

        @keyframes drawRing {
            to {
                stroke-dashoffset: 0
            }
        }

        @keyframes drawCheck {
            to {
                stroke-dashoffset: 0
            }
        }

        /* Confetti */
        .confetti {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 10px;
            height: 10px;
            border-radius: 2px;
            opacity: 0;
            animation: burst .8s .4s ease-out forwards
        }

        .confetti:nth-child(1) {
            background: #667eea;
            --x: -80px;
            --y: -120px;
            --r: 45deg
        }

        .confetti:nth-child(2) {
            background: #f093fb;
            --x: 90px;
            --y: -100px;
            --r: -30deg
        }

        .confetti:nth-child(3) {
            background: #10b981;
            --x: -110px;
            --y: -60px;
            --r: 90deg
        }

        .confetti:nth-child(4) {
            background: #fbbf24;
            --x: 70px;
            --y: -140px;
            --r: 180deg
        }

        .confetti:nth-child(5) {
            background: #f5576c;
            --x: -60px;
            --y: -150px;
            --r: -60deg
        }

        .confetti:nth-child(6) {
            background: #4facfe;
            --x: 120px;
            --y: -80px;
            --r: 120deg
        }

        .confetti:nth-child(7) {
            background: #764ba2;
            --x: -130px;
            --y: -90px;
            --r: -120deg
        }

        .confetti:nth-child(8) {
            background: #00f2fe;
            --x: 50px;
            --y: -160px;
            --r: 60deg
        }

        .confetti:nth-child(9) {
            background: #ff6b6b;
            --x: -40px;
            --y: -130px;
            --r: -90deg
        }

        .confetti:nth-child(10) {
            background: #a78bfa;
            --x: 100px;
            --y: -110px;
            --r: 150deg
        }

        .confetti:nth-child(11) {
            background: #34d399;
            --x: -100px;
            --y: -140px;
            --r: -45deg
        }

        .confetti:nth-child(12) {
            background: #fcd34d;
            --x: 80px;
            --y: -130px;
            --r: 30deg
        }

        @keyframes burst {
            0% {
                opacity: 1;
                transform: translate(0, 0) rotate(0) scale(0)
            }

            50% {
                opacity: 1
            }

            100% {
                opacity: 0;
                transform: translate(var(--x), var(--y)) rotate(var(--r)) scale(1)
            }
        }

        /* Typography */
        h1 {
            font-size: 48px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 12px;
            opacity: 0;
            animation: fadeUp .6s .6s ease forwards;
            text-shadow: 0 0 60px rgba(99, 102, 241, 0.4);
        }

        .subtitle {
            font-size: 20px;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.5;
            margin-bottom: 48px;
            opacity: 0;
            animation: fadeUp .6s .75s ease forwards;
        }

        .subtitle strong {
            background: linear-gradient(135deg, #667eea, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(20px);
                filter: blur(10px)
            }

            to {
                opacity: 1;
                transform: translateY(0);
                filter: blur(0)
            }
        }

        /* Features */
        .features {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 48px
        }

        .feat {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 22px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 50px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
            opacity: 0;
            animation: fadeUp .5s ease forwards;
            transition: all .25s;
        }

        .feat:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px)
        }

        .feat:nth-child(1) {
            animation-delay: .9s
        }

        .feat:nth-child(2) {
            animation-delay: 1s
        }

        .feat:nth-child(3) {
            animation-delay: 1.1s
        }

        .feat:nth-child(4) {
            animation-delay: 1.2s
        }

        .feat:nth-child(5) {
            animation-delay: 1.3s
        }

        .feat .icon {
            font-size: 18px
        }

        /* CTA */
        .cta-wrap {
            opacity: 0;
            animation: fadeUp .6s 1.4s ease forwards
        }

        .cta {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            padding: 18px 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            font-size: 18px;
            font-weight: 600;
            text-decoration: none;
            border-radius: 14px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(102, 126, 234, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            transition: all .3s;
        }

        .cta:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 40px rgba(102, 126, 234, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.2) inset
        }

        .cta::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 60%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shine 3s 2s infinite;
        }

        @keyframes shine {
            0% {
                left: -100%
            }

            20% {
                left: 150%
            }

            100% {
                left: 150%
            }
        }

        .cta svg {
            width: 20px;
            height: 20px;
            transition: transform .3s
        }

        .cta:hover svg {
            transform: translateX(4px)
        }

        .secondary {
            display: inline-block;
            margin-top: 24px;
            color: rgba(255, 255, 255, 0.5);
            text-decoration: none;
            font-size: 14px;
            transition: color .2s
        }

        .secondary:hover {
            color: rgba(255, 255, 255, 0.8)
        }

        /* Status */
        .status-wrap {
            margin-top: 16px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.4);
            min-height: 20px
        }

        #status:not(:empty) {
            color: rgba(255, 255, 255, 0.6)
        }

        #note {
            margin-top: 4px;
            font-size: 12px
        }

        /* Footer */
        .footer {
            margin-top: 60px;
            opacity: 0;
            animation: fadeUp .5s 1.6s ease forwards
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 24px
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.3);
            text-decoration: none;
            font-size: 13px;
            transition: color .2s
        }

        .footer-link:hover {
            color: rgba(255, 255, 255, 0.6)
        }

        /* Reduced motion */
        @media(prefers-reduced-motion:reduce) {

            *,
            *::before,
            *::after {
                animation-duration: .01ms !important;
                transition-duration: .01ms !important
            }

            .ring-progress {
                stroke-dashoffset: 0
            }

            .checkmark {
                stroke-dashoffset: 0
            }

            h1,
            .subtitle,
            .feat,
            .cta-wrap,
            .footer {
                opacity: 1;
                transform: none;
                filter: none
            }
        }
    </style>
</head>

<body>
    <!-- noscript GTM removed: JS required for handshake, noscript would leak install_id -->

    <main class="container">
        <!-- Success Ring with Confetti -->
        <div class="success-wrap">
            <svg class="success-ring" viewBox="0 0 120 120">
                <defs>
                    <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#667eea" />
                        <stop offset="100%" stop-color="#764ba2" />
                    </linearGradient>
                </defs>
                <circle class="ring-bg" cx="60" cy="60" r="54" />
                <circle class="ring-progress" cx="60" cy="60" r="54" transform="rotate(-90 60 60)" />
                <polyline class="checkmark" points="40 62 52 74 80 46" />
            </svg>
            <span class="confetti"></span><span class="confetti"></span><span class="confetti"></span>
            <span class="confetti"></span><span class="confetti"></span><span class="confetti"></span>
            <span class="confetti"></span><span class="confetti"></span><span class="confetti"></span>
            <span class="confetti"></span><span class="confetti"></span><span class="confetti"></span>
        </div>

        <!-- Text -->
        <h1>You're All Set!</h1>
        <p class="subtitle"><strong>ChatGPT Bookmark & Prompt Manager</strong> is ready.<br>Your ChatGPT experience just
            got supercharged.</p>

        <!-- Features -->
        <div class="features">
            <div class="feat"><span class="icon">&#11088;</span>Smart Bookmarks</div>
            <div class="feat"><span class="icon">&#128203;</span>Prompt Library</div>
            <div class="feat"><span class="icon">&#128279;</span>Tagging Chips</div>
            <div class="feat"><span class="icon">&#128269;</span>Powerful Search</div>
            <div class="feat"><span class="icon">&#9729;</span>Cloud Backup</div>
        </div>

        <!-- CTA -->
        <div class="cta-wrap">
            <a href="https://chatgpt.com" target="_blank" rel="noopener" class="cta" id="cta">
                Open ChatGPT
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="5" y1="12" x2="19" y2="12" />
                    <polyline points="12 5 19 12 12 19" />
                </svg>
            </a>
            <br>
            <a href="https://infolily.com" class="secondary">Explore all features &rarr;</a>
            <div class="status-wrap"><span id="status"></span>
                <div id="note"></div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-links">
                <a href="https://infolily.com/privacy-policy.html" class="footer-link">Privacy</a>
                <a href="https://infolily.com/terms.html" class="footer-link">Terms</a>
                <a href="https://infolily.com" class="footer-link">Home</a>
            </div>
        </footer>
    </main>

    <script>
        (function () {
            var API = 'https://api-cn.infolily.com/api/v1/install_link';
            // UUID v4 regex for handshake validation
            var UUID_RE = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;

            function isUUID(s) { return s && UUID_RE.test(s) }

            function genUUID() {
                if (typeof crypto !== 'undefined' && crypto.randomUUID) return crypto.randomUUID();
                var d = new Uint8Array(16);
                crypto.getRandomValues(d);
                d[6] = (d[6] & 0x0f) | 0x40;
                d[8] = (d[8] & 0x3f) | 0x80;
                var h = ''; for (var i = 0; i < 16; i++)h += (d[i] < 16 ? '0' : '') + d[i].toString(16);
                return h.slice(0, 8) + '-' + h.slice(8, 12) + '-' + h.slice(12, 16) + '-' + h.slice(16, 20) + '-' + h.slice(20);
            }

            function getCookie(n) {
                var m = document.cookie.match(new RegExp('(^| )' + n + '=([^;]+)'));
                return m ? m[2] : null;
            }

            function setCookie(n, v) {
                document.cookie = n + '=' + v + '; path=/; max-age=31536000; samesite=lax; secure';
            }

            function setUI(id, txt) { var e = document.getElementById(id); if (e) e.textContent = txt }

            function getAid() {
                var aid = null;
                try { aid = localStorage.getItem('aid') } catch (e) { }
                if (!isUUID(aid)) aid = getCookie('aid');
                if (!isUUID(aid)) {
                    aid = genUUID();
                    try { localStorage.setItem('aid', aid) } catch (e) { }
                    setCookie('aid', aid);
                }
                return aid;
            }

            function postLink(data) {
                var json = JSON.stringify(data);
                return fetch(API, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: json,
                    keepalive: true,
                    mode: 'cors',
                    credentials: 'omit'
                }).then(function (r) {
                    console.log('[welcome] POST response status', r.status);
                    return r.ok;
                }).catch(function (err) {
                    if (navigator.sendBeacon) {
                        var blob = new Blob([json], { type: 'application/json' });
                        var queued = navigator.sendBeacon(API, blob);
                        console.log('[welcome] POST sendBeacon queued', queued);
                        return queued;
                    }
                    console.log('[welcome] POST failed', err);
                    return false;
                });
            }

            // CTA click tracking
            var cta = document.getElementById('cta');
            if (cta) cta.onclick = function () { window.dataLayer && window.dataLayer.push({ event: 'cta_click', cta_location: 'welcome_page', cta_text: 'Open ChatGPT' }) };

            // Install handshake
            const installId = window.__install_id || new URLSearchParams(location.search).get('install_id');
            console.log('[welcome] installId detected', installId);

            if (!installId || !isUUID(installId)) { return; }

            var aid = getAid();
            console.log('[welcome] aid detected/created', aid);
            if (!isUUID(aid)) {
                setUI('status', 'Setup incomplete');
                setUI('note', 'Please try again later');
                return;
            }

            setUI('status', 'Linking...');

            console.log('[welcome] POST attempt', API, { install_id: installId, aid: aid });
            postLink({ install_id: installId, aid: aid })
                .then(function (ok) {
                    if (ok) {
                        setUI('status', 'Linking started - your extension will confirm.');
                        setUI('note', '');
                    } else {
                        setUI('status', 'We\'ll retry later');
                    }
                })
                .catch(function () {
                    setUI('status', 'We\'ll retry later');
                });
        })();
    </script>
</body>

</html>